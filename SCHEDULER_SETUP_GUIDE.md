# 📅 윈도우 작업 스케줄러 설정 가이드

골프 딜 뉴스 봇을 **평일 오전 9시~오후 6시, 30분마다** 자동으로 실행하는 방법입니다.

## 🚀 빠른 설정 (자동)

### 1단계: PowerShell 관리자 권한 실행

1. **시작 메뉴** 클릭
2. **"PowerShell"** 검색
3. **우클릭** → **"관리자 권한으로 실행"** 선택

### 2단계: 저장소 폴더로 이동

```powershell
cd C:\Users\사용자명\ground-stone
```

> 💡 **팁:** 실제 경로로 변경하세요. 예: `cd C:\Projects\ground-stone`

### 3단계: 설정 스크립트 실행

```powershell
.\setup_scheduler.ps1
```

### 4단계: 완료! ✅

스크립트가 자동으로 작업 스케줄러에 등록합니다.

## 📋 설정 내용

- **작업 이름:** GolfDealNewsBot
- **실행 요일:** 월요일 ~ 금요일 (평일만)
- **실행 시간:** 오전 9:00 ~ 오후 6:00
- **실행 간격:** 30분마다
- **총 실행 횟수:** 하루 19회
  - 9:00, 9:30, 10:00, 10:30, 11:00, 11:30, 12:00, 12:30
  - 13:00, 13:30, 14:00, 14:30, 15:00, 15:30, 16:00, 16:30
  - 17:00, 17:30, 18:00

## 🔍 확인 방법

### 작업 스케줄러에서 확인

1. `Win + R` 키 누르기
2. `taskschd.msc` 입력 후 엔터
3. 왼쪽 메뉴에서 **"작업 스케줄러 라이브러리"** 클릭
4. **"GolfDealNewsBot"** 작업 확인

### 작업 세부 정보 보기

- **일반 탭:** 작업 이름, 설명
- **트리거 탭:** 실행 시간 및 간격
- **동작 탭:** 실행할 파일 경로
- **기록 탭:** 실행 히스토리

## 🛠️ 수동 설정 (고급)

자동 스크립트가 작동하지 않을 경우 수동으로 설정할 수 있습니다.

### 1. 작업 스케줄러 열기

`Win + R` → `taskschd.msc`

### 2. 기본 작업 만들기

1. 우클릭 → **"기본 작업 만들기"**
2. 이름: `GolfDealNewsBot`
3. 설명: `골프 딜 뉴스 자동 수집`

### 3. 트리거 설정

1. **"매주"** 선택
2. 요일: **월, 화, 수, 목, 금** 체크
3. 시작 시간: **오전 9:00**

### 4. 동작 설정

1. **"프로그램 시작"** 선택
2. 프로그램/스크립트:
   ```
   C:\Users\사용자명\ground-stone\run_golf_bot.bat
   ```
3. 시작 위치:
   ```
   C:\Users\사용자명\ground-stone
   ```

### 5. 고급 설정

1. 작업을 우클릭 → **"속성"**
2. **"트리거"** 탭 → 트리거 편집
3. **"고급 설정"**:
   - ✅ 다음 간격으로 작업 반복: **30분**
   - ✅ 기간: **9시간**
   - ✅ 사용

### 6. 추가 설정

**"조건"** 탭:
- ☑️ 네트워크 연결 시에만 시작

**"설정"** 탭:
- ☑️ 작업이 실패할 경우 다시 시작 간격: **1분**
- ☑️ 작업을 요청 시 실행

## 🧪 테스트

설정이 완료되면 즉시 테스트해볼 수 있습니다:

1. 작업 스케줄러에서 **"GolfDealNewsBot"** 우클릭
2. **"실행"** 클릭
3. 텔레그램으로 뉴스가 오는지 확인

## ❓ 문제 해결

### 작업이 실행되지 않을 때

1. **Python 경로 확인**
   ```powershell
   python --version
   ```

2. **배치 파일 테스트**
   ```cmd
   C:\Users\사용자명\ground-stone\run_golf_bot.bat
   ```

3. **작업 스케줄러 기록 확인**
   - 작업 우클릭 → "속성" → "기록" 탭

### 작업이 실행되지만 봇이 작동하지 않을 때

1. **로그 파일 확인**
   ```
   C:\Users\사용자명\ground-stone\bot_execution_log.txt
   ```

2. **수동 실행 테스트**
   ```cmd
   cd C:\Users\사용자명\ground-stone
   python golf_deal_bot.py
   ```

## 🗑️ 작업 삭제

작업 스케줄러를 삭제하려면:

1. 작업 스케줄러 열기
2. **"GolfDealNewsBot"** 우클릭
3. **"삭제"** 클릭

또는 PowerShell에서:

```powershell
Unregister-ScheduledTask -TaskName "GolfDealNewsBot" -Confirm:$false
```

## 📞 지원

문제가 계속되면 Issue를 등록해주세요!
